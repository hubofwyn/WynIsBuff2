#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Run tests using Bun
echo "\nğŸ“‹ Running tests..."
bun run test || {
    echo "âŒ Tests failed. Please fix before committing."
    exit 1
}

# Architecture validation
echo "\nğŸ—ï¸  Validating architecture..."
bun run arch:validate || {
    echo "âŒ Architecture validation failed. Run 'bun run arch:check' for details."
    exit 1
}

# Boundary checks (allow 1 warning - documented SettingsScene TODO)
echo "\nğŸš§ Checking layer boundaries..."
bun run lint:boundaries --max-warnings=1 || {
    echo "âŒ Layer boundary violations detected. Fix architecture issues."
    exit 1
}

echo "\nâœ… Pre-commit checks passed!"
